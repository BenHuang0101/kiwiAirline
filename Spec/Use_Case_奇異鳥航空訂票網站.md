# 奇異鳥航空訂票網站 - Use Case 文件

## 文件資訊

- **文件名稱：** 奇異鳥航空訂票網站 Use Case 規格書
- **版本：** v1.0
- **撰寫人：** SA
- **日期：** 2025-07-17
- **文件狀態：** Draft

---

## Use Case 1：用戶註冊

| 項目          | 說明                                                                                                                                                              |
| ------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Use Case 名稱 | 用戶註冊                                                                                                                                                          |
| 主要角色      | 新用戶（Guest User）                                                                                                                                              |
| 前置條件      | 用戶未擁有系統帳戶，進入註冊頁面                                                                                                                                  |
| 主要流程      | 1. 用戶填寫註冊表單（姓名、電子郵件、密碼、確認密碼、手機號碼） → 2. 系統驗證輸入資料格式 → 3. 檢查電子郵件是否已被註冊 → 4. 建立新用戶帳戶 → 5. 顯示註冊成功訊息 |
| 備援流程      | 若電子郵件已被註冊，顯示錯誤訊息並提示用戶登入；若輸入格式錯誤，顯示相應錯誤提示                                                                                  |
| 對應 API      | POST /api/auth/register                                                                                                                                           |

---

## Use Case 2：用戶登入

| 項目          | 說明                                                                                            |
| ------------- | ----------------------------------------------------------------------------------------------- |
| Use Case 名稱 | 用戶登入                                                                                        |
| 主要角色      | 已註冊用戶（Registered User）                                                                   |
| 前置條件      | 用戶已擁有系統帳戶                                                                              |
| 主要流程      | 1. 用戶輸入電子郵件和密碼 → 2. 系統驗證登入資訊 → 3. 生成 JWT Token → 4. 跳轉至首頁或原請求頁面 |
| 備援流程      | 若登入資訊錯誤，顯示統一錯誤訊息並要求重新輸入                                                  |
| 對應 API      | POST /api/auth/login                                                                            |

---

## Use Case 3：航班搜尋

| 項目          | 說明                                                                                                                                                        |
| ------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Use Case 名稱 | 航班搜尋                                                                                                                                                    |
| 主要角色      | 旅客（Passenger）                                                                                                                                           |
| 前置條件      | 無（可為訪客或已登入用戶）                                                                                                                                  |
| 主要流程      | 1. 用戶選擇出發地和目的地 → 2. 選擇出發日期 → 3. 選擇乘客人數 → 4. 點擊搜尋按鈕 → 5. 系統查詢可用航班 → 6. 顯示航班搜尋結果列表 → 7. 用戶可按時間、價格排序 |
| 備援流程      | 若無可用航班，顯示無結果訊息並建議調整搜尋條件；若系統錯誤，顯示錯誤訊息並建議稍後再試                                                                      |
| 對應 API      | GET /api/flights/search                                                                                                                                     |

---

## Use Case 4：選擇航班並進入訂票流程

| 項目          | 說明                                                                                                        |
| ------------- | ----------------------------------------------------------------------------------------------------------- |
| Use Case 名稱 | 選擇航班並進入訂票流程                                                                                      |
| 主要角色      | 旅客（Passenger）                                                                                           |
| 前置條件      | 用戶已搜尋並查看航班搜尋結果                                                                                |
| 主要流程      | 1. 用戶從搜尋結果選擇特定航班 → 2. 查看航班詳細資訊 → 3. 確認選擇並點擊「預訂」 → 4. 跳轉至乘客資訊填寫頁面 |
| 備援流程      | 若航班已滿座，顯示無法預訂訊息並建議其他選項；若航班資訊更新，提示用戶重新搜尋                              |
| 對應 API      | GET /api/flights/{flightId}                                                                                 |

---

## Use Case 5：填寫乘客資訊

| 項目          | 說明                                                                                                                                          |
| ------------- | --------------------------------------------------------------------------------------------------------------------------------------------- |
| Use Case 名稱 | 填寫乘客資訊                                                                                                                                  |
| 主要角色      | 旅客（Passenger）                                                                                                                             |
| 前置條件      | 用戶已選擇航班，進入訂票流程                                                                                                                  |
| 主要流程      | 1. 用戶填寫每位乘客資訊（姓名、護照號碼、出生日期、聯絡方式） → 2. 系統驗證資訊格式 → 3. 顯示訂單摘要 → 4. 用戶確認資訊正確 → 5. 進入付款頁面 |
| 備援流程      | 若資訊格式錯誤，顯示錯誤提示並要求修正；若用戶已登入，可自動填入部分資訊                                                                      |
| 對應 API      | POST /api/bookings/passengers                                                                                                                 |

---

## Use Case 6：完成付款

| 項目          | 說明                                                                                                                                                                                |
| ------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Use Case 名稱 | 完成付款                                                                                                                                                                            |
| 主要角色      | 旅客（Passenger）                                                                                                                                                                   |
| 前置條件      | 用戶已填寫完成乘客資訊，進入付款頁面                                                                                                                                                |
| 主要流程      | 1. 用戶選擇付款方式（信用卡、ATM 轉帳） → 2. 填寫付款資訊 → 3. 系統處理付款請求 → 4. 第三方支付系統處理交易 → 5. 付款成功，建立訂單 → 6. 發送電子機票確認郵件 → 7. 顯示訂票成功頁面 |
| 備援流程      | 若付款失敗，顯示錯誤訊息並提供重新付款選項；若信用卡資訊錯誤，要求重新輸入                                                                                                          |
| 對應 API      | POST /api/bookings, POST /api/payments/process                                                                                                                                      |

---

## Use Case 7：查看訂單記錄

| 項目          | 說明                                                                                                        |
| ------------- | ----------------------------------------------------------------------------------------------------------- |
| Use Case 名稱 | 查看訂單記錄                                                                                                |
| 主要角色      | 已訂票用戶（Customer）                                                                                      |
| 前置條件      | 用戶已登入系統且擁有訂單記錄                                                                                |
| 主要流程      | 1. 用戶進入會員中心 → 2. 點擊「我的訂單」 → 3. 系統顯示用戶所有訂單列表 → 4. 用戶可點擊特定訂單查看詳細資訊 |
| 備援流程      | 若無訂單記錄，顯示空狀態頁面並提供航班搜尋連結                                                              |
| 對應 API      | GET /api/bookings/user/{userId}                                                                             |

---

## Use Case 8：修改訂單

| 項目          | 說明                                                                                                                                                                                  |
| ------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Use Case 名稱 | 修改訂單                                                                                                                                                                              |
| 主要角色      | 已訂票用戶（Customer）                                                                                                                                                                |
| 前置條件      | 用戶已登入並查看訂單詳情，訂單狀態允許修改                                                                                                                                            |
| 主要流程      | 1. 用戶點擊「修改訂單」 → 2. 選擇要修改的項目（日期、乘客資訊） → 3. 系統檢查修改可行性 → 4. 計算額外費用（如有） → 5. 用戶確認修改 → 6. 處理付款差額 → 7. 更新訂單並顯示修改成功頁面 |
| 備援流程      | 若航班已起飛或無法修改，顯示限制訊息；若需額外付款但失敗，取消修改操作                                                                                                                |
| 對應 API      | PUT /api/bookings/{bookingId}                                                                                                                                                         |

---

## Use Case 9：取消訂單

| 項目          | 說明                                                                                                                                                        |
| ------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Use Case 名稱 | 取消訂單                                                                                                                                                    |
| 主要角色      | 已訂票用戶（Customer）                                                                                                                                      |
| 前置條件      | 用戶已登入並查看訂單詳情，訂單狀態允許取消                                                                                                                  |
| 主要流程      | 1. 用戶點擊「取消訂單」 → 2. 系統顯示取消政策和手續費說明 → 3. 用戶確認取消 → 4. 系統處理退款（扣除手續費） → 5. 更新訂單狀態為已取消 → 6. 顯示取消成功頁面 |
| 備援流程      | 若航班已起飛或無法取消，顯示限制訊息；若退款處理失敗，記錄問題並通知客服                                                                                    |
| 對應 API      | DELETE /api/bookings/{bookingId}                                                                                                                            |

---

## Use Case 10：聯絡客服

| 項目          | 說明                                                                                                                                                   |
| ------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Use Case 名稱 | 聯絡客服                                                                                                                                               |
| 主要角色      | 用戶（User）                                                                                                                                           |
| 前置條件      | 用戶需要協助或遇到問題                                                                                                                                 |
| 主要流程      | 1. 用戶進入客服頁面 → 2. 選擇問題類型 → 3. 查看相關 FAQ → 4. 若 FAQ 無法解決，填寫聯絡表單 → 5. 系統記錄問題並分配給客服人員 → 6. 發送問題提交確認郵件 |
| 備援流程      | 若系統忙碌，提供電話客服聯絡方式；若 FAQ 已能解決問題，用戶可直接結束流程                                                                              |
| 對應 API      | POST /api/support/tickets, GET /api/support/faq                                                                                                        |

---

## Use Case 11：系統錯誤處理

| 項目          | 說明                                                                                                                                                                                                  |
| ------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Use Case 名稱 | 系統錯誤處理                                                                                                                                                                                          |
| 主要角色      | 系統（System）                                                                                                                                                                                        |
| 前置條件      | 系統運行中發生錯誤                                                                                                                                                                                    |
| 主要流程      | 1. 系統偵測到錯誤發生 → 2. 判斷錯誤類型（網路、伺服器、資料驗證、權限、業務邏輯） → 3. 記錄錯誤日誌 → 4. 顯示適當的錯誤訊息給用戶 → 5. 根據錯誤嚴重程度決定是否自動通知技術團隊 → 6. 提供錯誤恢復選項 |
| 備援流程      | 若錯誤日誌記錄失敗，使用備用日誌機制；若用戶介面無法顯示錯誤，提供基本的錯誤頁面                                                                                                                      |
| 對應 API      | POST /api/logs/error, GET /api/system/health                                                                                                                                                          |

---

## Use Case 12：航班資料同步

| 項目          | 說明                                                                                                                                                                                                      |
| ------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Use Case 名稱 | 航班資料同步                                                                                                                                                                                              |
| 主要角色      | 系統（System）                                                                                                                                                                                            |
| 前置條件      | 外部航班資料來源有更新                                                                                                                                                                                    |
| 主要流程      | 1. 接收外部航班資料更新觸發 → 2. 驗證接收資料格式 → 3. 比對現有資料差異 → 4. 更新航班資料 → 5. 檢查影響的現有訂單 → 6. 通知受影響的用戶 → 7. 發送航班變更通知郵件 → 8. 更新相關訂單狀態 → 9. 記錄同步日誌 |
| 備援流程      | 若資料驗證失敗，記錄錯誤並告警技術團隊；若同步過程中斷，提供手動重新同步機制                                                                                                                              |
| 對應 API      | POST /api/admin/flights/sync, GET /api/admin/sync/status                                                                                                                                                  |

---

✏️ _最後更新時間：2025-07-17_
